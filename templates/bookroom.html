{% extends 'layout.html' %}

{% block content %}
    <style>
        .room-section {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            min-height: 100vh;
            padding: 80px 0 40px;
        }

        .room-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        .room-gallery {
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .room-gallery img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .room-gallery img:hover {
            transform: scale(1.05);
        }

        .thumbnail-gallery {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .thumbnail {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .thumbnail.active {
            border-color: #ffc107;
        }

        .amenity-badge {
            background: #ffc107;
            color: #000;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .price-tag {
            font-size: 2.5rem;
            font-weight: bold;
            color: #dc3545;
        }

        .feature-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .feature-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
            color: #ffc107;
        }

        .booking-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
        }

        .btn-primary {
            background-color: #ffc107;
            border-color: #ffc107;
            color: #000;
            border-radius: 10px;
            padding: 15px 30px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #e0a800;
            border-color: #e0a800;
            color: #000;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.3);
        }

        .detail-item {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .trust-badge {
            text-align: center;
            padding: 10px;
        }

        .trust-badge i {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        #hotelCarousel {
            width: 800px !important; /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∞—à—É —à–∏—Ä–∏–Ω—É */
            height: 450px !important; /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤—ã—Å–æ—Ç—É */
            overflow: hidden;
        }

        /* 2. –ü–†–ò–ù–£–ñ–î–ê–ï–ú –í–°–ï –í–ù–£–¢–†–ï–ù–ù–ò–ï –ö–û–ù–¢–ï–ô–ù–ï–†–´ –ó–ê–ù–Ø–¢–¨ 100% –í–´–°–û–¢–´ */
        #hotelCarousel .carousel-inner,
        #hotelCarousel .carousel-item {
            width: 100% !important;
            height: 100% !important; /* –ö–õ–Æ–ß–ï–í–û–ô –ú–û–ú–ï–ù–¢ */
            /* –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ–Ω, —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å –ª—é–±—ã–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω–æ */
            background-color: #000;
        }

        /* 3. –ü–†–ò–ù–£–ñ–î–ê–ï–ú –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï –ö –ó–ê–ü–û–õ–ù–ï–ù–ò–Æ –ò –û–ë–†–ï–ó–ö–ï */
        #hotelCarousel img {
            width: 100% !important;
            height: 100% !important;
            object-fit: cover !important; /* –ì–ê–†–ê–ù–¢–ò–†–£–ï–ú –û–ë–†–ï–ó–ö–£ */
        }
    </style>

    <section class="room-section">
        <div class="container">
            <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'home' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'hotels' %}">–û—Ç–µ–ª–∏</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'hotel' hotel.id %}">{{ hotel.name }}</a></li>
                    <li class="breadcrumb-item active">{{ room.name }}</li>
                </ol>
            </nav>

            <div class="room-card">
                <div class="row">
                    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–º–µ—Ä–µ -->
                    <div class="col-lg-8">
                        <!-- –ì–∞–ª–µ—Ä–µ—è -->
                            <div id="hotelCarousel" class="carousel slide carousel-fixed-height" data-bs-ride="carousel">

                            <div class="carousel-indicators">
                                <button type="button" data-bs-target="#hotelCarousel" data-bs-slide-to="0"
                                        class="active" aria-current="true" aria-label="Slide 1"></button>

                                {% for file in files %}
                                    <button type="button" data-bs-target="#hotelCarousel"
                                            data-bs-slide-to="{{ forloop.counter }}"
                                            aria-label="Slide {{ forloop.counter|add:1 }}"></button>
                                {% endfor %}
                            </div>

                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <img src="{{ room.primary_photo.file.url }}"
                                         class="d-block"
                                         loading="eager"
                                         alt="{{ room.name }} - –û—Å–Ω–æ–≤–Ω–æ–µ —Ñ–æ—Ç–æ">
                                </div>

                                {% for file in files %}
                                    <div class="carousel-item">
                                        <img src="{{ file.file.url }}"
                                             class="d-block"
                                             loading="lazy"
                                             alt="{{ room.name }} - –§–æ—Ç–æ {{ forloop.counter|add:1 }}">
                                    </div>
                                {% endfor %}
                            </div>

                            <button class="carousel-control-prev" type="button" data-bs-target="#hotelCarousel"
                                    data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#hotelCarousel"
                                    data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>

                        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                        <h1 class="mt-4 mb-3">{{ room.name }}</h1>
                        <p class="lead text-muted mb-4">{{ room.description|default:"–ü—Ä–æ—Å—Ç–æ—Ä–Ω—ã–π –∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞–±–µ–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º" }}</p>

                        <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <h5 class="mb-3">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–æ–º–µ—Ä–∞</h5>
                                <div class="feature-item">
                                    <svg class="feature-icon" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                    </svg>
                                    <span><strong>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> –¥–æ {{ room.max_people|default:"2" }} –≥–æ—Å—Ç–µ–π</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M1 3.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9zM2 4v8h12V4H2z"/>
                                    </svg>
                                    <span><strong>–ü–ª–æ—â–∞–¥—å:</strong> {{ room.area|default:"25" }} –º¬≤</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H2z"/>
                                        <path d="M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                                    </svg>
                                    <span><strong>–¢–∏–ø –∫—Ä–æ–≤–∞—Ç–∏:</strong> {{ room.bed_type|default:"–î–≤—É—Å–ø–∞–ª—å–Ω–∞—è" }}</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5 class="mb-3">–£–¥–æ–±—Å—Ç–≤–∞</h5>
                                <div>
                                    {% for comfort in room.comforts.all %}
                                        <span class="amenity-badge">{{ comfort.name }}</span>
                                    {% empty %}
                                        <span class="amenity-badge">–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä</span>
                                        <span class="amenity-badge">Wi-Fi</span>
                                        <span class="amenity-badge">–¢–µ–ª–µ–≤–∏–∑–æ—Ä</span>
                                        <span class="amenity-badge">–ú–∏–Ω–∏-–±–∞—Ä</span>
                                        <span class="amenity-badge">–°–µ–π—Ñ</span>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <!-- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
                        <div class="mb-4">
                            <h5>–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</h5>
                            <p class="text-muted">
                                {{ room.description|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }}
                            </p>
                        </div>

                        <!-- –ü—Ä–∞–≤–∏–ª–∞ –æ—Ç–µ–ª—è -->
                        <div class="card border-0 bg-light">
                            <div class="card-body">
                                <h6 class="card-title">üí° –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h6>
                                <ul class="mb-0 small">
                                    <li>–ó–∞–µ–∑–¥: —Å 14:00, –≤—ã–µ–∑–¥: –¥–æ 12:00</li>
                                    <li>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –æ—Ç–º–µ–Ω–∞ –∑–∞ 48 —á–∞—Å–æ–≤ –¥–æ –∑–∞–µ–∑–¥–∞</li>
                                    <li>–†–∞–∑–º–µ—â–µ–Ω–∏–µ —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏: –ø–æ –∑–∞–ø—Ä–æ—Å—É</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ -->
                    <div class="col-lg-4">
                        <div class="sticky-top" style="top: 20px;">
                            <div class="booking-card">
                                <h4 class="text-center mb-4">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä</h4>

                                <div class="text-center mb-4">
                                    <div class="price-tag">{{ room.price }} ‚ÇΩ</div>
                                    <small class="text-muted">–∑–∞ –Ω–æ—á—å</small>
                                </div>

                                <form method="post" action="" id="bookingForm">
                                    {% csrf_token %}

                                    <div class="mb-3">
                                        <label class="form-label fw-bold">–î–∞—Ç—ã –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="date" class="form-control" name="check_in" id="checkIn"
                                                       required>
                                                <small class="form-text text-muted">–ó–∞–µ–∑–¥</small>
                                            </div>
                                            <div class="col-6">
                                                <input type="date" class="form-control" name="check_out" id="checkOut"
                                                       required>
                                                <small class="form-text text-muted">–í—ã–µ–∑–¥</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label fw-bold">–ì–æ—Å—Ç–∏</label>
                                        <select class="form-select" name="guests" required>
                                            <option value="1">1 –≤–∑—Ä–æ—Å–ª—ã–π</option>
                                            <option value="2" selected>2 –≤–∑—Ä–æ—Å–ª—ã—Ö</option>
                                            <option value="3">2 –≤–∑—Ä–æ—Å–ª—ã—Ö + 1 —Ä–µ–±–µ–Ω–æ–∫</option>
                                            <option value="4">2 –≤–∑—Ä–æ—Å–ª—ã—Ö + 2 —Ä–µ–±–µ–Ω–∫–∞</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label fw-bold">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–º–µ—Ä–æ–≤</label>
                                        <select class="form-select" name="rooms_count" required>
                                            <option value="1" selected>1 –Ω–æ–º–µ—Ä</option>
                                            <option value="2">2 –Ω–æ–º–µ—Ä–∞</option>
                                            <option value="3">3 –Ω–æ–º–µ—Ä–∞</option>
                                        </select>
                                    </div>

                                    <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å -->
                                    <div class="alert alert-light border-0 mb-4">
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ 2 –Ω–æ—á–∏:</span>
                                            <strong>6 000 ‚ÇΩ</strong>
                                        </div>
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–±–æ—Ä:</span>
                                            <strong>300 ‚ÇΩ</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="d-flex justify-content-between fw-bold fs-5">
                                            <span>–ò—Ç–æ–≥–æ:</span>
                                            <strong class="text-success">6 300 ‚ÇΩ</strong>
                                        </div>
                                        <small class="text-muted d-block mt-2">
                                            <i class="bi bi-info-circle"></i> –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –æ—Ç–º–µ–Ω–∞ –¥–æ 48 —á–∞—Å–æ–≤ –¥–æ –∑–∞–µ–∑–¥–∞
                                        </small>
                                    </div>

                                    <button type="submit" class="btn btn-primary w-100 btn-lg">
                                        <svg width="20" height="20" fill="currentColor" class="me-2">
                                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H2z"/>
                                            <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V4zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>
                                        </svg>
                                        –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å
                                    </button>
                                </form>

                                <!-- –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞–∫–∏ -->
                                <div class="row text-center mt-4">
                                    <div class="col-4">
                                        <div class="trust-badge text-primary">
                                            <i class="bi bi-shield-check"></i>
                                            <div class="small">–ë–µ–∑–æ–ø–∞—Å–Ω–æ</div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="trust-badge text-success">
                                            <i class="bi bi-credit-card"></i>
                                            <div class="small">–û–ø–ª–∞—Ç–∞ –æ–Ω–ª–∞–π–Ω</div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="trust-badge text-warning">
                                            <i class="bi bi-headset"></i>
                                            <div class="small">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –æ—Ç–µ–ª—è -->
                            <div class="card border-0 bg-light mt-4">
                                <div class="card-body">
                                    <h6 class="card-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã –æ—Ç–µ–ª—è</h6>
                                    <p class="mb-2">
                                        <i class="bi bi-telephone text-primary me-2"></i>
                                        {{ hotel.phone|default:"+7 (495) 123-45-67" }}
                                    </p>
                                    <p class="mb-2">
                                        <i class="bi bi-envelope text-primary me-2"></i>
                                        {{ hotel.email|default:"info@hotel.ru" }}
                                    </p>
                                    <p class="mb-0">
                                        <i class="bi bi-geo-alt text-primary me-2"></i>
                                        {{ hotel.location|default:"–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 123" }}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // –°–º–µ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≥–∞–ª–µ—Ä–µ–µ
        function changeImage(thumb) {
            const mainImage = document.getElementById('mainImage');
            mainImage.src = thumb.src;

            document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
            thumb.classList.add('active');
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç
        document.addEventListener('DOMContentLoaded', function () {
            const checkIn = document.getElementById('checkIn');
            const checkOut = document.getElementById('checkOut');

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É - —Å–µ–≥–æ–¥–Ω—è
            const today = new Date().toISOString().split('T')[0];
            checkIn.min = today;
            checkOut.min = today;

            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –¥–ª—è –≤—ã–µ–∑–¥–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞—Ç—ã –∑–∞–µ–∑–¥–∞
            checkIn.addEventListener('change', function () {
                checkOut.min = this.value;
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('bookingForm').addEventListener('submit', function (e) {
                if (!checkIn.value || !checkOut.value) {
                    e.preventDefault();
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã –∑–∞–µ–∑–¥–∞ –∏ –≤—ã–µ–∑–¥–∞');
                    return;
                }

                if (new Date(checkOut.value) <= new Date(checkIn.value)) {
                    e.preventDefault();
                    alert('–î–∞—Ç–∞ –≤—ã–µ–∑–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –∑–∞–µ–∑–¥–∞');
                    return;
                }
            });
        });
    </script>
{% endblock %}