<!-- client/dashboard.html -->
{% extends 'layout.html' %}

{% block content %}
    <style>
        .client-section {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            min-height: 100vh;
            padding: 80px 0 40px;
        }

        .client-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #f8f9fa;
            transition: all 0.3s ease;
        }

        .stats-card:hover {
            border-color: #ffc107;
            transform: translateY(-5px);
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ffc107;
            margin-bottom: 5px;
        }

        .stats-label {
            color: #6c757d;
            font-weight: 500;
        }

        .hotel-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #f8f9fa;
            transition: all 0.3s ease;
        }

        .hotel-card:hover {
            border-color: #ffc107;
            transform: translateY(-2px);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-draft {
            background: #6c757d;
            color: white;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .btn-primary {
            background-color: #ffc107;
            border-color: #ffc107;
            color: #000;
            border-radius: 10px;
            padding: 12px 30px;
            font-weight: 600;
        }

        .btn-primary:hover {
            background-color: #e0a800;
            border-color: #e0a800;
            color: #000;
        }

        .nav-tabs .nav-link {
            border: none;
            color: #6c757d;
            font-weight: 500;
            padding: 12px 25px;
        }

        .nav-tabs .nav-link.active {
            color: #ffc107;
            border-bottom: 3px solid #ffc107;
            background: transparent;
        }
    </style>

    <section class="client-section">
        <div class="container">
            {% if messages %}
                <div class="mb-4">
                    {% for message in messages %}
                        <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show"
                             role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
            <div class="client-card">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="display-5 fw-bold mb-3">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.first_name }}!</h1>
                        <p class="lead text-muted">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º–∏ –æ—Ç–µ–ª—è–º–∏ –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏</p>
                    </div>
                    <div class="col-md-4 text-end">
                        <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal"
                                data-bs-target="#addHotelModal">
                            <svg width="20" height="20" fill="currentColor" class="me-2">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–µ–ª—å
                        </button>
                    </div>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="row g-4 mb-4">
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number">{{ total_hotels }}</div>
                        <div class="stats-label">–í—Å–µ–≥–æ –æ—Ç–µ–ª–µ–π</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number">{{ approved_hotels }}</div>
                        <div class="stats-label">–û–¥–æ–±—Ä–µ–Ω–æ</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number">{{ pending_hotels }}</div>
                        <div class="stats-label">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-number">0</div>
                        <div class="stats-label">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <ul class="nav nav-tabs mb-4" id="clientTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="hotels-tab" data-bs-toggle="tab" data-bs-target="#hotels"
                            type="button" role="tab">
                        üè® –ú–æ–∏ –æ—Ç–µ–ª–∏
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="bookings-tab" data-bs-toggle="tab" data-bs-target="#bookings"
                            type="button" role="tab">
                        üìã –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile"
                            type="button" role="tab">
                        üë§ –ü—Ä–æ—Ñ–∏–ª—å
                    </button>
                </li>
            </ul>

            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
            <div class="tab-content" id="clientTabsContent">
                <!-- –í–∫–ª–∞–¥–∫–∞ –æ—Ç–µ–ª–µ–π -->
                <div class="tab-pane fade show active" id="hotels" role="tabpanel">
                    <div class="client-card">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3>–ú–æ–∏ –æ—Ç–µ–ª–∏</h3>
                            <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal"
                                    data-bs-target="#addHotelPhotoModal">
                                <svg width="16" height="16" fill="currentColor" class="me-1">
                                    <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                                    <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
                                </svg>
                                –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ
                            </button>
                        </div>

                        {% if hotels %}
                            {% for hotel in hotels %}
                                <div class="hotel-card">
                                    <div class="row align-items-center">
                                        <div class="col-md-2">
                                                {% if hotel.primary_photo.file.url %}
                                                    <img src="{{ hotel.primary_photo.file.url }}"
                                                         class="img-fluid rounded"
                                                         style="height: 100px; object-fit: cover; width: 100%;"
                                                         alt="{{ hotel.name }}">
                                                {% else %}
                                                    <div class="bg-light rounded d-flex align-items-center justify-content-center"
                                                         style="height: 100px;">
                                                        <small class="text-muted">–ù–µ—Ç —Ñ–æ—Ç–æ</small>
                                                    </div>
                                                {% endif %}
                                        </div>
                                        <div class="col-md-6">
                                            <h5 class="mb-1">{{ hotel.name }}</h5>
                                            <p class="text-muted mb-2">
                                                <svg width="16" height="16" fill="currentColor"
                                                     class="bi bi-geo-alt me-1">
                                                    <path d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z"/>
                                                    <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                </svg>
                                                {{ hotel.city }}, {{ hotel.location|truncatewords:5 }}
                                            </p>
                                            <div class="mb-2">
                                            <span class="badge bg-light text-dark me-1">
                                                {% with ''|center:hotel.stars as range %}
                                                    {% for i in range %}‚òÖ{% endfor %}
                                                {% endwith %}
                                            </span>
                                                <span class="status-badge status-{{ hotel.status_id }}">
                                                {{ hotel.status.name }}
                                            </span>
                                            </div>

                                        </div>


                                        <div class="col-md-2 text-center">
                                            <div class="h5 text-success">{{ hotel.hotel_room_set.count }}</div>
                                            <small class="text-muted">—Ç–∏–ø–æ–≤ –Ω–æ–º–µ—Ä–æ–≤</small>
                                        </div>
                                        <div class="col-md-2">
                                            <a href="{% url 'rooms' hotel.id %}"
                                               class="btn btn-outline-primary btn-sm w-100 mb-2">
                                                –£–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–º–µ—Ä–∞–º–∏
                                            </a>
                                            <a href="#" class="btn btn-outline-secondary btn-sm w-100">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
                                        </div>


                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="text-center py-5">
                                <svg width="64" height="64" fill="#6c757d" viewBox="0 0 16 16">
                                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                                </svg>
                                <h4 class="mt-3 text-muted">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ç–µ–ª–µ–π</h4>
                                <p class="text-muted">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –æ—Ç–µ–ª—å —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</p>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π -->
                <div class="tab-pane fade" id="bookings" role="tabpanel">
                    <div class="client-card">
                        <h3 class="mb-4">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                        <div class="text-center py-5">
                            <svg width="64" height="64" fill="#6c757d" viewBox="0 0 16 16">
                                <path d="M6.5 1A1.5 1.5 0 0 0 5 2.5V3H1.5A1.5 1.5 0 0 0 0 4.5v8A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-8A1.5 1.5 0 0 0 14.5 3H11v-.5A1.5 1.5 0 0 0 9.5 1h-3zm0 1h3a.5.5 0 0 1 .5.5V3H6v-.5a.5.5 0 0 1 .5-.5zm1.5 5a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5z"/>
                            </svg>
                            <h4 class="mt-3 text-muted">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</h4>
                            <p class="text-muted">–ö–æ–≥–¥–∞ –≥–æ—Å—Ç–∏ –Ω–∞—á–Ω—É—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–∏ –æ—Ç–µ–ª–∏, –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –∑–∞–∫–∞–∑—ã</p>
                        </div>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
                <div class="tab-pane fade" id="profile" role="tabpanel">
                    <div class="client-card">
                        <h3 class="mb-4">–ü—Ä–æ—Ñ–∏–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞</h3>
                        <div class="row">
                            <div class="col-md-8">
                                <form>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">–ò–º—è</label>
                                            <input type="text" class="form-control" value="{{ owner.user.first_name }}">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">–§–∞–º–∏–ª–∏—è</label>
                                            <input type="text" class="form-control" value="{{ owner.user.last_name }}">
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-control" value="{{ owner.user.email }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                        <input type="tel" class="form-control" value="{{ owner.phone }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</label>
                                        <input type="text" class="form-control" value="{{ owner.company_name }}">
                                    </div>
                                    <div class="mb-4">
                                        <label class="form-label">–û —Å–µ–±–µ</label>
                                        <textarea class="form-control" rows="4">{{ owner.description }}</textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                                </form>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-0 bg-light">
                                    <div class="card-body">
                                        <h5 class="card-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞</h5>
                                        <p class="mb-2"><strong>–î–∞—Ç–∞
                                            —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong><br>{{ owner.user.date_joined|date:"d.m.Y" }}</p>
                                        <p class="mb-2"><strong>–û—Ç–µ–ª–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ:</strong><br>{{ total_hotels }}</p>
                                        <p class="mb-0"><strong>–°—Ç–∞—Ç—É—Å:</strong><br>–ê–∫—Ç–∏–≤–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–µ–ª—è -->
        <div class="modal fade" id="addHotelModal" tabindex="-1" aria-labelledby="addHotelModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                    <div class="modal-header">
                        <h5 class="modal-title" id="addHotelModalLabel">
                            <svg width="24" height="24" fill="#ffc107" class="me-2">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –æ—Ç–µ–ª—å
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <!-- –§–æ—Ä–º–∞ -->
                    <form method="post" action="{% url 'client_add_hotel' %}" enctype="multipart/form-data">
                        {% csrf_token %}


                        <div class="modal-body">
                            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
                            <div class="mb-4">
                                <div class="d-flex justify-content-between mb-2">
                                    <small class="text-muted">–®–∞–≥ 1 –∏–∑ 2: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</small>
                                    <small class="text-muted">–ó–∞–ø–æ–ª–Ω–µ–Ω–æ: <span id="formProgress">0%</span></small>
                                </div>
                                <div class="progress" style="height: 6px;">
                                    <div class="progress-bar bg-warning" id="progressBar" style="width: 0%"></div>
                                </div>
                            </div>

                            <div class="row g-3">
                                <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–µ–ª—è -->
                                <div class="col-md-12">
                                    <label for="hotelName" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–µ–ª—è *</label>
                                    <input type="text" class="form-control" id="hotelName" name="name" required
                                           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–µ–ª—è">
                                </div>

                                <!-- –ì–æ—Ä–æ–¥ –∏ –∑–≤–µ–∑–¥—ã -->
                                <div class="col-md-8">
                                    <label for="hotelCity" class="form-label">–ì–æ—Ä–æ–¥ *</label>
                                    <input type="text" class="form-control" id="hotelCity" name="city" required
                                           placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥">
                                </div>
                                <div class="col-md-4">
                                    <label for="hotelStars" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ *</label>
                                    <select class="form-select" id="hotelStars" name="stars" required>
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                                        <option value="1">1 –∑–≤–µ–∑–¥–∞</option>
                                        <option value="2">2 –∑–≤–µ–∑–¥—ã</option>
                                        <option value="3" selected>3 –∑–≤–µ–∑–¥—ã</option>
                                        <option value="4">4 –∑–≤–µ–∑–¥—ã</option>
                                        <option value="5">5 –∑–≤–µ–∑–¥</option>
                                    </select>
                                </div>

                                <!-- –ê–¥—Ä–µ—Å -->
                                <div class="col-12">
                                    <label for="hotelAddress" class="form-label">–ê–¥—Ä–µ—Å *</label>
                                    <textarea class="form-control" id="hotelAddress" name="location" rows="2" required
                                              placeholder="–ü–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –æ—Ç–µ–ª—è"></textarea>
                                </div>

                                <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
                                <div class="col-md-6">
                                    <label for="hotelPhone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω –æ—Ç–µ–ª—è *</label>
                                    <input type="tel" class="form-control" id="hotelPhone" name="phone" required
                                           placeholder="+7 (XXX) XXX-XX-XX">
                                </div>
                                <div class="col-md-6">
                                    <label for="hotelEmail" class="form-label">Email –æ—Ç–µ–ª—è</label>
                                    <input type="email" class="form-control" id="hotelEmail" name="email"
                                           placeholder="email@example.com">
                                </div>

                                <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                                <div class="col-12">
                                    <label for="hotelDescription" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–µ–ª—è *</label>
                                    <textarea class="form-control" id="hotelDescription" name="about" rows="4"
                                              required
                                              placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–µ–ª—å, –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞..."></textarea>
                                    <div class="form-text">–ú–∏–Ω–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤. <span id="charCount">0</span>/100</div>
                                </div>

                                <div class="col-md-6">
                                    <label for="hotelToCenter" class="form-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–Ω—Ç—Ä–∞ (–∫–º)</label>
                                    <input type="number" class="form-control" id="hotelToCenter" name="to_center"
                                           placeholder="0" step="0.1" min="0">
                                    <div class="form-text">–û—Å—Ç–∞–≤—å—Ç–µ 0, –µ—Å–ª–∏ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ</div>
                                </div>

                            </div>

                            <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ -->
                            <div class="alert alert-light mt-4">
                                <h6 class="alert-heading">üí° –°–æ–≤–µ—Ç—ã –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é:</h6>
                                <ul class="mb-0 small">
                                    <li>–£–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∞–¥—Ä–µ—Å –æ—Ç–µ–ª—è</li>
                                    <li>–î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –≥–æ—Å—Ç–µ–π</li>
                                    <li>–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</li>
                                    <li>–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–µ–ª—è –≤—ã —Å–º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä–∞ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ</li>
                                </ul>
                            </div>
                        </div>

                        <!-- –§—É—Ç–µ—Ä –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit" class="btn btn-primary" id="submitBtn">
                                <svg width="16" height="16" fill="currentColor" class="me-1">
                                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H2z"/>
                                    <path d="M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                                    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                </svg>
                                –°–æ–∑–¥–∞—Ç—å –æ—Ç–µ–ª—å
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal fade" id="addHotelPhotoModal" tabindex="-1" aria-labelledby="addHotelPhotoModalLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addHotelPhotoModalLabel">
                            <svg width="24" height="24" fill="#ffc107" class="me-2">
                                <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                                <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
                            </svg>
                            –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –∫ –æ—Ç–µ–ª—é
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <form method="post" action="{% url 'client_add_photo' %}" enctype="multipart/form-data"
                          id="addPhotoForm">
                        {% csrf_token %}

                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="photoHotelSelect" class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–µ–ª—å *</label>
                                <select class="form-select" id="photoHotelSelect" name="hotel_id" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—à–∏—Ö –æ—Ç–µ–ª–µ–π...</option>
                                    {% for hotel in hotels %}
                                        <option value="{{ hotel.id }}">{{ hotel.name }}</option>
                                    {% endfor %}
                                </select>
                                <div class="form-text">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –±—É–¥–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –æ—Ç–µ–ª—é.</div>
                            </div>

                            <div class="mb-4">
                                <label for="hotelPhotoFile" class="form-label">–§–∞–π–ª —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ *</label>
                                <input class="form-control" type="file" id="hotelPhotoFile" name="image" required
                                       accept="image/*">
                                <div class="form-text">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 5MB. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ:
                                    1920x1080.
                                </div>
                            </div>

                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" value="1" id="isPrimaryCheck"
                                       name="is_primary">
                                <label class="form-check-label" for="isPrimaryCheck">
                                    –°–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Ñ–æ—Ç–æ –æ—Å–Ω–æ–≤–Ω—ã–º –¥–ª—è –æ—Ç–µ–ª—è
                                </label>
                            </div>

                            <div class="mb-3">
                                <label for="photoDescription" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ç–æ (–¥–ª—è SEO)</label>
                                <input type="text" class="form-control" id="photoDescription" name="description"
                                       placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ç–æ">
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞
                            </button>
                            <button type="submit" class="btn btn-primary" id="uploadPhotoBtn">
                                <svg width="16" height="16" fill="currentColor" class="me-1">
                                    <path d="M4.5 10.5A.5.5 0 0 0 5 11h6a.5.5 0 0 0 0-1H5a.5.5 0 0 0-.5.5z"/>
                                    <path d="M2.678 11.894a1 1 0 0 1 .448-.82l2.973-2.483.876.876-.97 2.053a1 1 0 0 1-.448.82L3.12 14.5a.5.5 0 0 1-.955-.38l.513-2.226zM15 12.5a.5.5 0 0 1-.5.5H1a.5.5 0 0 1-.5-.5v-1A1.5 1.5 0 0 1 2 10h12a1.5 1.5 0 0 1 1.5 1.5v1zM2 9.5A1.5 1.5 0 0 1 .5 8V4.5A1.5 1.5 0 0 1 2 3h12A1.5 1.5 0 0 1 15.5 4.5V8A1.5 1.5 0 0 1 14 9.5H2z"/>
                                </svg>
                                –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </section>

    <script>
        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫
        const triggerTabList = [].slice.call(document.querySelectorAll('#clientTabs button'))
        triggerTabList.forEach(function (triggerEl) {
            const tabTrigger = new bootstrap.Tab(triggerEl)
            triggerEl.addEventListener('click', function (event) {
                event.preventDefault()
                tabTrigger.show()
            })
        })


        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('#addHotelModal form');
            const inputs = form.querySelectorAll('input[required], textarea[required], select[required]');
            const submitBtn = document.getElementById('submitBtn');
            const progressBar = document.getElementById('progressBar');
            const formProgress = document.getElementById('formProgress');
            const charCount = document.getElementById('charCount');
            const descriptionTextarea = document.getElementById('hotelDescription');

            // –°—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è
            descriptionTextarea.addEventListener('input', function () {
                const count = this.value.length;
                charCount.textContent = count;

                if (count >= 100) {
                    charCount.className = 'text-success';
                } else {
                    charCount.className = 'text-danger';
                }

                updateProgress();
            });

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            function updateProgress() {
                let filledCount = 0;

                inputs.forEach(input => {
                    if (input.type === 'file') {
                        // –î–ª—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—ã–±—Ä–∞–Ω —Ñ–∞–π–ª
                        if (input.files.length > 0) filledCount++;
                    } else if (input.type === 'select-one') {
                        // –î–ª—è —Å–µ–ª–µ–∫—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                        if (input.value !== '') filledCount++;
                    } else {
                        // –î–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ –ø—É—Å—Ç–æ–µ
                        if (input.value.trim() !== '') filledCount++;
                    }
                });

                // –û—Å–æ–±–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è (–º–∏–Ω–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤)
                if (descriptionTextarea.value.length >= 100) {
                    filledCount++;
                }

                const progress = Math.round((filledCount / (inputs.length + 1)) * 100);
                progressBar.style.width = progress + '%';
                formProgress.textContent = progress + '%';

                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å 100%
                submitBtn.disabled = progress < 100;

                // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                if (progress < 50) {
                    progressBar.className = 'progress-bar bg-danger';
                } else if (progress < 100) {
                    progressBar.className = 'progress-bar bg-warning';
                } else {
                    progressBar.className = 'progress-bar bg-success';
                }
            }

            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ –≤—Å–µ—Ö –ø–æ–ª—è—Ö
            inputs.forEach(input => {
                input.addEventListener('input', updateProgress);
                input.addEventListener('change', updateProgress);
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            form.addEventListener('submit', function (e) {
                const description = descriptionTextarea.value.trim();

                if (description.length < 100) {
                    e.preventDefault();
                    alert('–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤');
                    descriptionTextarea.focus();
                    return;
                }

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                submitBtn.disabled = true;
                submitBtn.innerHTML = `
                <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                –°–æ–∑–¥–∞–µ–º –æ—Ç–µ–ª—å...
            `;
            });

            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('addHotelModal').addEventListener('hidden.bs.modal', function () {
                form.reset();
                progressBar.style.width = '0%';
                formProgress.textContent = '0%';
                charCount.textContent = '0';
                charCount.className = '';
                submitBtn.disabled = true;
                submitBtn.innerHTML = `
                <svg width="16" height="16" fill="currentColor" class="me-1">
                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H2z"/>
                    <path d="M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                </svg>
                –°–æ–∑–¥–∞—Ç—å –æ—Ç–µ–ª—å
            `;
            });
        });


        // ‚≠êÔ∏è –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê –î–õ–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê –§–û–¢–û
        document.addEventListener('DOMContentLoaded', function () {
            const photoForm = document.getElementById('addPhotoForm');
            const uploadPhotoBtn = document.getElementById('uploadPhotoBtn');

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã —Ñ–æ—Ç–æ
            photoForm.addEventListener('submit', function (e) {
                // –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä
                uploadPhotoBtn.disabled = true;
                uploadPhotoBtn.innerHTML = `
                    <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                    –ó–∞–≥—Ä—É–∑–∫–∞...
                `;
            });

            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('addHotelPhotoModal').addEventListener('hidden.bs.modal', function () {
                photoForm.reset();
                uploadPhotoBtn.disabled = false;
                uploadPhotoBtn.innerHTML = `
                    <svg width="16" height="16" fill="currentColor" class="me-1">
                        <path d="M4.5 10.5A.5.5 0 0 0 5 11h6a.5.5 0 0 0 0-1H5a.5.5 0 0 0-.5.5z"/>
                        <path d="M2.678 11.894a1 1 0 0 1 .448-.82l2.973-2.483.876.876-.97 2.053a1 1 0 0 1-.448.82L3.12 14.5a.5.5 0 0 1-.955-.38l.513-2.226zM15 12.5a.5.5 0 0 1-.5.5H1a.5.5 0 0 1-.5-.5v-1A1.5 1.5 0 0 1 2 10h12a1.5 1.5 0 0 1 1.5 1.5v1zM2 9.5A1.5 1.5 0 0 1 .5 8V4.5A1.5 1.5 0 0 1 2 3h12A1.5 1.5 0 0 1 15.5 4.5V8A1.5 1.5 0 0 1 14 9.5H2z"/>
                    </svg>
                    –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ
                `;
            });
        });
    </script>
{% endblock %}